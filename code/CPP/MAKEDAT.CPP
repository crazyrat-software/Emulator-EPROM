#include <conio.h>
#include <dos.h>
#include <dir.h>
#include <stdio.h>
#include <stdlib.h>
#include <string.h>
#include <io.h>
#include <fcntl.h>
#include <sys\stat.h>

 int DAT;
 unsigned char temp;
 unsigned char buf[80];

unsigned char Kolory[15]=
{0,0x70,0x70,0x1F,0x71,0x03,0x05,0x1F,0x07,0x0F,0x70,0x7F,0x20,0x2E,0x00};
//Kolory:
//0
//1 - menu glownego
//2 - menu rozwijanego
//3 - zaznaczenia menu
//4 - paska statusu
//5 - tekst w oknie glownym
//6 - ramka w oknie glownym
//7 - zaznaczenia w oknie glownym i dialogowym
//8 - adresu w oknie glownym
//9 - etykiety w oknie glownym
//10- tekst w oknie dialogowym
//11- ramka w oknie dialogowym
//12- przycisk nie wybrany
//13- przycisk wybrany
//14-

unsigned char Ramki[3][11]={
{218,191,192,217,196,179,194,180,193,195,197},
{201,187,200,188,205,186,203,185,202,204,206},
{209,207,199,182,220,223,221,222,176,177,178}};

unsigned char PL_1[9][16]={
{0x00,0x00,0x10,0x38,0x6c,0xc6,0xc6,0xfe,0xc6,0xc6,0xc6,0xc6,0x0c,0x18,0x18,0x0e}, //A
{0x0c,0x18,0x3c,0x66,0xc2,0xc0,0xc0,0xc0,0xc0,0xc2,0x66,0x3c,0x00,0x00,0x00,0x00}, //C
{0x00,0x00,0xfe,0x66,0x62,0x68,0x78,0x68,0x60,0x62,0x66,0xfe,0x18,0x18,0x0e,0x00}, //E
{0x00,0x00,0xf0,0x60,0x68,0x78,0x70,0xe0,0xe0,0x62,0x66,0xfe,0x00,0x00,0x00,0x00}, //L
{0x0c,0x18,0xc6,0xe6,0xf6,0xfe,0xde,0xce,0xc6,0xc6,0xc6,0xc6,0x00,0x00,0x00,0x00}, //N
{0x0e,0x18,0x7c,0xc6,0xc6,0xc6,0xc6,0xc6,0xc6,0xc6,0xc6,0x7c,0x00,0x00,0x00,0x00}, //O
{0x0e,0x18,0x7c,0xc6,0xc6,0x60,0x38,0x0c,0x06,0xc6,0xc6,0x7c,0x00,0x00,0x00,0x00}, //S
{0x0e,0x18,0xff,0xc3,0x86,0x0c,0x18,0x30,0x60,0xc1,0xc3,0xff,0x00,0x00,0x00,0x00}, //Zi
{0x00,0x00,0xff,0xc3,0x86,0x0c,0x7e,0x30,0x60,0xc1,0xc3,0xff,0x00,0x00,0x00,0x00}};//Z

unsigned char PL_2[9][16]={
{0x00,0x00,0x00,0x00,0x00,0xf8,0x0c,0x7c,0xcc,0xcc,0xcc,0x76,0x0c,0x18,0x1b,0x0e}, //a
{0x00,0x00,0x0c,0x18,0x00,0x7c,0xc6,0xc0,0xc0,0xc0,0xc6,0x7c,0x00,0x00,0x00,0x00}, //c
{0x00,0x00,0x00,0x00,0x00,0x7c,0xc6,0xfe,0xc0,0xc0,0xc6,0x7c,0x18,0x30,0x36,0x1c}, //e
{0x00,0x00,0x38,0x18,0x18,0x1e,0x1c,0x38,0x78,0x18,0x18,0x3c,0x00,0x00,0x00,0x00}, //l
{0x00,0x00,0x0c,0x18,0x00,0xdc,0x66,0x66,0x66,0x66,0x66,0x66,0x00,0x00,0x00,0x00}, //n
{0x00,0x00,0x0c,0x18,0x00,0x7c,0xc6,0xc6,0xc6,0xc6,0xc6,0x7c,0x00,0x00,0x00,0x00}, //o
{0x00,0x00,0x0c,0x18,0x00,0x7c,0xc6,0x60,0x38,0x0c,0xc6,0x7c,0x00,0x00,0x00,0x00}, //s
{0x00,0x00,0x0c,0x18,0x00,0xfe,0xcc,0x18,0x30,0x60,0xc6,0xfe,0x00,0x00,0x00,0x00}, //zi
{0x00,0x00,0x18,0x18,0x00,0xfe,0xcc,0x18,0x30,0x60,0xc6,0xfe,0x00,0x00,0x00,0x00}};//z

unsigned char WriteZnaki(void)
{
 gotoxy(2,2);printf("Zapisuje: Polskie znaki 1");
 lseek(DAT,0,SEEK_END);
 write(DAT,PL_1,144);
 gotoxy(2,3);printf("Zapisuje: Polskie znaki 2");
 lseek(DAT,0,SEEK_END);
 write(DAT,PL_2,144);
 return 0;
}

unsigned char WriteKolory(void)
{
 gotoxy(2,4);printf("Zapisuje: Kolory");
 lseek(DAT,0,SEEK_END);
 write(DAT,Kolory,15);
 return 0;
}

unsigned char WriteRamki(void)
{
 gotoxy(2,5);printf("Zapisuje: Obramowania");
 lseek(DAT,0,SEEK_END);
 write(DAT,Ramki,33);
 return 0;
}

unsigned char WriteCode(unsigned char A,unsigned char B,
		       unsigned char Len,unsigned char *Str)
{
 lseek(DAT,0,SEEK_END);
 buf[0]=A;
 buf[1]=B;
 buf[2]=Len;
 for (temp=0;temp!=Len;temp++) buf[temp+3]=Str[temp];
 temp=temp+3;
 write(DAT,buf,temp);
 return 0;
}

void ConvertCode_DAT(void)
{
 int CDAT,error;
 unsigned char A,B,C,q;
 unsigned char D[80];

 CDAT=open("CODES.DAT",O_BINARY | O_RDONLY,S_IREAD);
 gotoxy(2,6);printf("Zapisuje: Dane DeAsemblera 8051");
 do {
     error=read(CDAT,buf,19);
     if (error<=0) break;
     A=buf[0];
     B=buf[1];
     C=buf[2];
     for (q=0;q!=C;q++) D[q]=buf[q+3];
     D[q]=0;
     gotoxy(3,7);printf("Code   =   h");
     gotoxy(3,8);printf("MnemStr=                                         ");
     gotoxy(3,7);printf("Code   = %Xh",A);
     gotoxy(3,8);printf("MnemStr= %s",D);
     WriteCode(A,B,C,D);
 } while (error!=-1);
 close(CDAT);
}

void main(void)
{
clrscr();
DAT=open("EEPROM.DAT",O_BINARY | O_CREAT | O_RDWR,S_IREAD | S_IWRITE);
WriteZnaki();
WriteKolory();
WriteRamki();
ConvertCode_DAT();
close(DAT);
}